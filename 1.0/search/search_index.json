{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"DBackUp","text":""},{"location":"#example-docker-composeyml","title":"Example docker-compose.yml","text":"<pre><code>    version: \"3.9\"\n\n    services:\n    dbackup:\n        build: ./source\n        container_name: DBackUp\n        volumes:\n        - /var/run/docker.sock:/var/run/docker.sock\n        - ./work:/app/work\n        - ./ssh_key:/app/ssh_key\n        labels:\n        - dbackup.runner=this\n        restart: no\n\n        env_file:\n        - .env\n\n    postgres:\n        image: postgres:16\n        environment:\n        POSTGRES_PASSWORD: example\n        labels:\n        - dbackup.on=true\n        - mytool.type=\"postgres\"\n        volumes:\n        - pgdata:/var/lib/postgresql/data\n\n    sqlite:\n        image: alpine\n        command: [\"sh\", \"-c\", \"sleep infinity\"]\n        labels:\n        - dbackup.on=true\n        - mytool.type=\"sqlite\"\n        volumes:\n        - ./sqlite-data:/data\n\n    volumes:\n    pgdata: \n</code></pre>"},{"location":"#requirements","title":"Requirements","text":"<p>Note: Currently works only with docker compose</p> <ul> <li> <p>Every docker container you want to backup, you need to mark with label  <pre><code>- dbackup.on=true\n</code></pre></p> </li> <li> <p>The container that is DBackUp, you need to mark with label <pre><code>- dbackup.runner=this\n</code></pre></p> </li> <li> <p>If you want to use copy over ssh, you need to provide a ssh_key, see SCP Repository.</p> </li> </ul>"},{"location":"#example-env","title":"Example .env","text":"<pre><code>ON_EVENTS_BACKUP=true\nPERIODIC_SCAN=true\n\nREPOS=telegram,scp\n\nTELEGRAM_BOT_TOKEN=your_token\nTELEGRAM_USER_IDS=user_id,user_id2\n\nREMOTE_ADDRESSES=root@some.random.ip.address:/destination_folder,root@some.other.ip.address:/destination_folder2\n</code></pre>"},{"location":"repositories/repository/","title":"Repository","text":""},{"location":"repositories/repository/#repository-is-destination-for-your-files","title":"Repository is destination for your files","text":""},{"location":"repositories/repository/#types","title":"Types","text":"<p>You can define different types of Repositories. For that add in <code>.env</code> file under <code>REPOS</code> a avaliable Repositories <pre><code>REPOS=telegram,scp\n</code></pre> If you want multiple Repositories you need to separate them with comma <code>,</code></p> <p>Following Repositories are avaliable now</p>"},{"location":"repositories/repository/#telegram","title":"telegram","text":"Backups are send as messages containing the files"},{"location":"repositories/repository/#scp","title":"scp","text":"Backups are send as files to remote machine"},{"location":"repositories/scp-repository/","title":"Scp repository","text":""},{"location":"repositories/scp-repository/#what-is-scp","title":"What is SCP?","text":"<p>SCP stands for Secure Copy Protocol. With it you can transfer files from one machine to another with ssh.</p> <p>But this tool uses rsync, basicly it is the same thing but in different package. </p>"},{"location":"repositories/scp-repository/#ssh-key","title":"SSH Key","text":"<p>To transfer files with ease and secure, you need to provide a private key to DBackUp and a public key on your Destination Remote.</p>"},{"location":"repositories/scp-repository/#how-do-i-obtain-those-keys","title":"How do I obtain those keys?","text":"<ul> <li>You need openssh installed on your machine.</li> <li>Then use (Works on Linux and Windows):  <pre><code>ssh-keygen -t ed25519 -f /path/to/folder/key_name\n</code></pre></li> </ul> <p>You will get two file in the folder you have choosed:</p> <ol> <li><code>key_name</code> DBackUp needs it</li> <li><code>key_name.pub</code> Destination machine needs it</li> </ol>"},{"location":"repositories/scp-repository/#what-do-i-do-with-those-keys","title":"What do I do with those keys?","text":""},{"location":"repositories/scp-repository/#for-key_namepub","title":"For <code>key_name.pub</code>","text":"<ol> <li>you need to add to end of <code>authorized_keys</code> file on the destination machine. it is located in <code>~/.ssh/</code> on Linux</li> </ol>"},{"location":"repositories/scp-repository/#for-key_name","title":"For <code>key_name</code>","text":"<ol> <li> <p>You need to copy it to the directory where DBackUp <code>docker-compose.yml</code> is.</p> </li> <li> <p>Bind it to the container in <code>volume:</code> like  <pre><code>volume:\n    - key_name:/app/ssh_key\n</code></pre></p> </li> </ol>"},{"location":"repositories/scp-repository/#destination-remotes","title":"Destination Remotes","text":"<p>Destination Remote the remotes that would recive the backups</p> <p>You can add them into your <code>.env</code> file under <code>REMOTE_ADDRESSES</code> variable: <pre><code>REMOTE_ADDRESSES=root@some.random.ip.address:/destination_folder\n</code></pre></p> <p>If you want multiple Destination Remotes, you can separate them with comma <code>,</code></p> <p>Every Destination Remote should have <code>rsync</code> installed on them.</p> <ul> <li> <p>Windows</p> <ul> <li> <p>Install WSL  <pre><code>wsl --install\n</code></pre></p> </li> <li> <p>Inside WSL run  <pre><code>sudo apt install rsync\n</code></pre></p> </li> </ul> </li> <li> <p>Windows (Chocolatey) <pre><code>choco install rsync\n</code></pre></p> </li> </ul> <ul> <li> <p>macOS</p> <ul> <li> <p>Install brew <pre><code>/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh\" \n</code></pre></p> </li> <li> <p>Run  <pre><code>brew install rsync\n</code></pre></p> </li> </ul> </li> </ul> <ul> <li>Debian / Ubuntu <pre><code>sudo apt update\nsudo apt install rsync\n</code></pre></li> </ul> <ul> <li>Alpine <pre><code>sudo apk add rsync\n</code></pre></li> </ul>"},{"location":"repositories/telegram-repository/","title":"Telegram repository","text":""},{"location":"repositories/telegram-repository/#telegram-token","title":"Telegram Token","text":"<p>You need to obtain a telegram token to use Telegram Repository</p> <p>After that you can easly put it in the <code>.env</code> under <code>TELEGRAM_BOT_TOKEN</code> variable: <pre><code>TELEGRAM_BOT_TOKEN=your_token\n</code></pre></p>"},{"location":"repositories/telegram-repository/#user","title":"User","text":"<p>User is the real user that would recive a message from your bot</p>"},{"location":"repositories/telegram-repository/#where-do-i-get-the-ids","title":"Where do I get the IDs?","text":"<p>There are many way to do so. Mostly you need a bot, like userinfobot.</p> <p>Be carefull do not trust anybody that wants your data, like phone / credit card number, etc</p> <p>We are not responsible for any of your losts (money, personal data, etc.)</p>"},{"location":"repositories/telegram-repository/#what-do-i-do-with-ids","title":"What do I do with IDs?","text":"<p>You can add them into your <code>.env</code> file under <code>TELEGRAM_USER_IDS</code> variable: <pre><code>TELEGRAM_USER_IDS=user_id1,user_id2\n</code></pre></p> <p>If you want multiple Users, you can separate them with comma <code>,</code></p>"},{"location":"settings/event-scan/","title":"Event scan","text":""},{"location":"settings/event-scan/#what-is-it","title":"What is it?","text":"<p>Event Scan create backups immediately when container is started or updated</p> <p>You can enable it in <code>.env</code> file under <code>ON_EVENTS_BACKUP</code> variable</p> <p><pre><code>ON_EVENTS_BACKUP=true\n</code></pre> (By default it is disabled)</p>"},{"location":"settings/event-scan/#how-it-works","title":"How it works","text":"<ol> <li>Monitor containers</li> <li>Detect change</li> <li>Backup data</li> <li>Send to configured repositories</li> </ol> <p>Runs continuously.</p>"},{"location":"settings/event-scan/#use-it-when","title":"Use it when","text":"<ul> <li>changes must be backed up instantly</li> <li>data is critical or frequently updated</li> </ul>"},{"location":"settings/periodic-scan/","title":"Periodic scan","text":""},{"location":"settings/periodic-scan/#what-is-it","title":"What is it?","text":"<p>Periodic Scan checks files at fixed time intervals and backs up anything that changed since the last scan.</p> <p>Default time is 7 day (604800 seconds), you can define your own time in <code>.env</code> file under <code>RUN_TASK</code> variable</p> <pre><code>RUN_TASK=604800\n</code></pre> <p>You can disable it in same <code>.env</code> file under <code>PERIODIC_SCAN</code> variable</p> <p><pre><code>PERIODIC_SCAN=false\n</code></pre> (By default it is enabled)</p>"},{"location":"settings/periodic-scan/#how-it-works","title":"How it works","text":"<ol> <li>Wait for scan interval</li> <li>Scan directories</li> <li>Backup data</li> <li>Send to repositories</li> </ol> <p>Repeats forever.</p>"},{"location":"settings/periodic-scan/#use-it-when","title":"Use it when","text":"<p>scheduled backups are enough</p>"}]}